Генерация и тестирование ключевой последовательности (Лаба 2)

Инф. поток - > (преобразование) < - генератор ключей

message XOR key = crypto
message = crypto XOR key

1)Как создать хороший ключ
2)Как проверить ключ
3)Проверка успешности шифрования (статистический анализ)

UTF-8: (L символов текста)*(16 бит) = L*16 - длина ключа!

message = key (в битовой области)   - идеал

message = 2*key (в битовой области) - хуже

message = 4*key (в битовой области) - плохо

Статистический анализ:
Тест на равномерность и тест на случайность (NIST)

!!!Сериальный тест (на равномерность) !!!
Исходные данные: последовательность 0 и 1 (110111...)
Подстроки длиной k - битов, желательно, чтобы каждые k - биты встречались с вероятностью Pj = (1/2^k)
1. Желательно, чтобы М битов = 10000 и более!
2. k - задать N = (M/k) число подстрок в последовательности

Идеал   : N(T:j) = (N/2^k) = (M/(k*2^k)) (вероятность равномерна)
Реал    : N(Э:j) =                       (возникают флуктуации)

Почему?
1) Гипотеза U - последовательность равномерна, а флуктуации объясняются малой выборкой.
2) Гипотеза U2 - флуктуации возникают из-за неравномерности последовательности

Выбираем одну из гипотез ("принятие решения").
Необходимо внести статистический критерий!
Используем критерий Хи^2 Пирсона! (для расчета меры отклонения)
В идеале критерий Пирсона должно стремиться к нулю (отклонение нулевое)
1) Если критерий превосходит пороговый уровень X^2 > X^2(кр) -> Гипотеза U2 (2)
2) Если критерий не превосходит пороговый уровень X^2 <= X^2(кр) -> Гипотеза U (1)

P(X^2 > X^2(кр)|U) = alpha - ошибка первого рода (уровень значимости критерия)
P(X^2 <= X^2(кр)|U2) = betta - ошибка второго рода

0% <= alpha <= 100%
h = 2^k - 1

X^2(кр)(alpha = 1) = 0
X^2(кр)(alpha -> 0) = бесконечность

!!! Корреляционный тест (тест на случайность)!!!

Rk = M((Xi - mi)*(X(i+k)-m(i+k)))/(sqrt(D(Xi)*D(X(i+k))))
(фото формул на доске в телефоне)

-1 <= Rk <= 1 (Rk -> 0 - идеал) (желательно, чтобы коэффициент корреляции Rk стремился к нулю)
|Rk| -> 1 (абсолютно неслучайна)

10101010 - Rk = -1 (отрицательный коэффициент корреляции)
01010101 - Rk = 1 (положительный коэффициент корреляции)

Если |Rk|<=R(кр) - U
Если |Rk|>R(кр) - U2



Про генераторы М-последовательности:
Сдвиговый регистр с обратной связью

